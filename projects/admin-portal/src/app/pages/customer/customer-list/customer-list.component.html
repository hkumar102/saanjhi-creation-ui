<saanjhi-ui-confirm-dialog #confirmDialog />
<div class="grid" [formGroup]="form">
    <div class="col-12 md:col-8 lg:col-6">
        <div class="flex flex-wrap gap-4">
            <div class="flex-1">
                <saanjhi-ui-input inputId="search" label="Search" formControlName="search"
                    placeholder="Search by name, email, or phone">
                </saanjhi-ui-input>
            </div>

            <div class="flex gap-2">
                <saanjhi-ui-button label="Search" icon="pi pi-search" type="button" (click)="loadCustomers(true)" />
                <saanjhi-ui-button label="Clear" type="button" severity="secondary" (click)="clearFilters()" />
            </div>
        </div>
    </div>

    <div class="col-12 md:col-4 lg:col-6 text-right">
        <saanjhi-ui-button label="Add Customer" icon="pi pi-plus" type="button" (click)="navigateToCreate()" />
    </div>
</div>

<p-table [value]="customers" [loading]="loading" [lazy]="true" [paginator]="false" [totalRecords]="totalRecords"
    [rows]="pageSize" [first]="(page - 1) * pageSize" (onLazyLoad)="onLazyLoad($event)" [sortField]="sortField"
    [sortOrder]="sortOrder" class="w-full">
    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="name">Name <p-sortIcon field="name" /></th>
            <th pSortableColumn="email">Email <p-sortIcon field="email" /></th>
            <th pSortableColumn="phoneNumber">Phone <p-sortIcon field="phoneNumber" /></th>
            <th>Address Count</th>
            <th>Actions</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-customer>
        <tr>
            <td>{{ customer.name }}</td>
            <td>{{ customer.email }}</td>
            <td>{{ customer.phoneNumber }}</td>
            <td>{{ customer.addresses?.length }}</td>

            <td>
                <saanjhi-ui-button icon="pi pi-pencil" label="Edit" type="button" class="p-button-sm"
                    (click)="navigateToEdit(customer.id)" />
                <saanjhi-ui-button label="Delete" icon="pi pi-trash" severity="danger" type="button"
                    (click)="onDelete(customer)"></saanjhi-ui-button>
            </td>
        </tr>
    </ng-template>
</p-table>

<p-paginator [rows]="pageSize" [totalRecords]="totalRecords" [first]="(page - 1) * pageSize"
    (onPageChange)="onPageChange($event)">
</p-paginator>