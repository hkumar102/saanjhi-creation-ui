<saanjhi-ui-confirm-dialog #confirmDialog />

<!-- Header with Add Button -->
<div class="flex justify-content-between align-items-center mb-4">
  <h2 class="text-xl font-bold">Category List</h2>
  <saanjhi-ui-button label="Add Category" icon="pi pi-plus" (click)="onCreate()" severity="info" />
</div>

<!-- Search and Filters -->
<p-card styleClass="mb-4">
  <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="flex flex-column gap-3">
    <div class="grid">
      <div class="col-12 md:col-6 lg:col-4">
        <saanjhi-ui-form-field label="Search Categories" inputId="search">
          <saanjhi-ui-input formControlName="search" inputId="search" placeholder="Search by name or description..."
            class="w-full" />
        </saanjhi-ui-form-field>
      </div>
    </div>

    <div class="flex gap-2">
      <saanjhi-ui-button type="submit" label="Search" icon="pi pi-search" severity="warn" />
      <saanjhi-ui-button type="button" label="Clear" icon="pi pi-times" severity="secondary"
        (click)="onClearSearch()" />
    </div>
  </form>
</p-card>

<!-- Data Table with Responsive Layout -->
<saanjhi-ui-card>
  <p-table [value]="categories()" [lazy]="true" [paginator]="true" [totalRecords]="totalRecords()" [loading]="loading()"
    [rows]="pageSize" [rowsPerPageOptions]="[10, 20, 50]" (onLazyLoad)="loadCategories($event)" [sortField]="sortField"
    [sortOrder]="sortOrder" dataKey="id" responsiveLayout="stack" [breakpoint]="'576px'" class="shadow-1">

    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name">
          Name
          <p-sortIcon field="name" />
        </th>
        <th pSortableColumn="description">
          Description
          <p-sortIcon field="description" />
        </th>
        <th style="width: 150px;">Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-category>
      <tr>
        <td data-label="Name">
          <span class="p-column-title">
            Name
          </span>
          <span class="font-semibold">{{ category.name || 'Unnamed Category' }}</span>
        </td>
        <td data-label="Description">
          <span class="p-column-title">
            Description
          </span>
          <span class="text-600">{{ category.description || 'No description' }}</span>
        </td>
        <td data-label="Actions">
          <span class="p-column-title">
            Actions
          </span>
          <div class="flex gap-2">
            <saanjhi-ui-button icon="pi pi-pencil" size="small" severity="info" pTooltip="Edit Category"
              (click)="onEdit(category)" />
            <saanjhi-ui-button icon="pi pi-trash" size="small" severity="danger" pTooltip="Delete Category"
              (click)="onDelete(category)" />
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="3" class="text-center py-4">
          <div class="flex flex-column align-items-center gap-3">
            <i class="pi pi-search text-4xl text-400"></i>
            <span class="text-600">No categories found</span>
            <saanjhi-ui-button label="Add First Category" icon="pi pi-plus" (click)="onCreate()" />
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="loadingbody">
      <tr>
        <td colspan="3" class="text-center py-4">
          <div class="flex align-items-center justify-content-center gap-2">
            <i class="pi pi-spin pi-spinner text-2xl"></i>
            <span>Loading categories...</span>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</saanjhi-ui-card>